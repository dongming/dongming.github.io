<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="MING'S BLOG">
<meta property="og:url" content="https://dongming.github.io/index.html">
<meta property="og:site_name" content="MING'S BLOG">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MING'S BLOG">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://dongming.github.io/"/>





  <title> MING'S BLOG </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">MING'S BLOG</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle"></p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://dongming.github.io/2017/03/05/linux中文件与文件夹的权限/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="MING">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="MING'S BLOG">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="MING'S BLOG" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/05/linux中文件与文件夹的权限/" itemprop="url">
                  linux中文件与目录的权限
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-05T21:38:29+08:00">
                2017-03-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/03/05/linux中文件与文件夹的权限/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/03/05/linux中文件与文件夹的权限/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="linux中文件的权限"><a href="#linux中文件的权限" class="headerlink" title="linux中文件的权限"></a>linux中文件的权限</h2><p>最近看了《鸟哥的linxu私房菜》其中涉及到linux中文件的权限问题，对于一个已经有过一定linux使用经验的人来说，也许知道了rwx三个分别代表了什么样的权限。在平时的使用中如果没有出问题，也许就不会去特地系统性的学习一下linux的文件和目录权限。很多时候都是google或者百度就是为了解决眼前的问题，不看书总结就不会有系统的知识。</p>
<h3 id="linux文件的权限"><a href="#linux文件的权限" class="headerlink" title="linux文件的权限"></a>linux文件的权限</h3><p>我的linux机器(ubuntu server)上的/etc目录下执行ll命令，显示如下的文件与目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">drwxr-xr-x  9 root root    4096 Feb 17 18:01 apparmor.d/</div><div class="line">drwxr-xr-x  3 root root    4096 Feb 17 18:00 apport/</div><div class="line">drwxr-xr-x  6 root root    4096 Feb 17 18:05 apt/</div><div class="line">-rw-r-----  1 root daemon   144 Jan 14  2016 at.deny</div><div class="line">-rw-r--r--  1 root root    2188 Aug 31  2015 bash.bashrc</div><div class="line">-rw-r--r--  1 root root      45 Aug 12  2015 bash_completion</div></pre></td></tr></table></figure>
<p>其中第一个字符为”d”的代表这是一个目录，”-“的代表是一个文件，这个一般使用过linux的都了解。第一个字符后跟着三组权限分别对应着user，group，others用户的权限。我们拿bash.bashrc文件为例，其权限为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-rw-r--r--  1 root root    2188 Aug 31  2015 bash.bashrc</div></pre></td></tr></table></figure>
<p>这个文件是属于root的，对应的用户组也是root。其对应权限”rw- r– r–”,说明root本身对其有rw的权限，而其同组的其他用户和其他非同组的用户对其只有可取权限。这个都是非常好理解的，其实文件的权限还是非常好理解的。</p>
<p>权限还可以用数字来表示，经常会听说600,755,777权限等，这个主要是指在权限表中r权限的值为4，w权限值为2，x权限值为1，而平常所说的755三个数字分别表示user，group，others的权限。那么7就是代表的这个用户对这个文件有rwx的权限，同组的其他用户对这个文件是rx的权限，其他用户对这个用户也是rx的权限。</p>
<p>当我作为一个others用户去修改一个我没有w权限的文件时会发生什么情况呢？我用mars用户去修改root用户的bash.bashrc文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">echo &quot;hello world&quot;</div><div class="line">&quot;bash.bashrc&quot;</div><div class="line">&quot;bash.bashrc&quot; E212: Can&apos;t open file for writing</div><div class="line">Press ENTER or type command to continue</div></pre></td></tr></table></figure>
<p>我在这个文件的最后增加了echo “hello world”这句话，当我执行保存时，会出现Can’t open file for writing的错误，说明我们队这个文件是没有写的权限的。</p>
<p>对于文件的权限还是比较好理解的</p>
<h3 id="linux中目录的权限"><a href="#linux中目录的权限" class="headerlink" title="linux中目录的权限"></a>linux中目录的权限</h3><p>上面的例子显示目录也是有对应的rwx的权限的，今天看书的时候才对目录的权限了解的这么细致。我就做了一下实验，来看看目录的权限分别表示什么</p>
<p>我使用root账户在/tmp目录下建立了一个目录act，并且在里面建立了一个properties的文件server.properties。并且设置这个目录对于others的用户只有r权限:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">drwxr--r--  2 root root 4096 Mar  5 09:35 act/</div></pre></td></tr></table></figure>
<p>root对这个目录有rwx的权限，而我一个others的mars用户对这个目录只有r的权限，我去访问以下这个目录试试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">mars@ubuntu:/tmp$ ls act/</div><div class="line">ls: cannot access &apos;act/server.properties&apos;: Permission denied</div><div class="line">server.properties</div><div class="line">mars@ubuntu:/tmp$ cd act/</div><div class="line">-su: cd: act/: Permission denied</div></pre></td></tr></table></figure>
<p> 对于只有r权限的目录，我只能看到这个目录下有哪些文件，对于cd操作是没有权限的，也就是我无法进入这个目录</p>
<p> 想要进入这个目录怎么办呢？加入x的权限，这里x的权限不是文件的执行权限，而是用户能够进入这个工作目录的(access)权限。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">drwxr-xr-x  2 root root 4096 Mar  5 09:35 act/</div></pre></td></tr></table></figure>
<p> 现在目录的权限已经变更为755了，我的mars用户对这个目录具有的access的权限。看下面的操作</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">mars@ubuntu:/tmp$ cd act/</div><div class="line">mars@ubuntu:/tmp/act$ ll</div><div class="line">total 8</div><div class="line">drwxr-xr-x 2 root root 4096 Mar  5 09:35 ./</div><div class="line">drwxrwxrwt 9 root root 4096 Mar  5 09:50 ../</div><div class="line">-rw-r--r-- 1 root root    0 Mar  5 09:35 server.properties</div></pre></td></tr></table></figure>
<p>现在mars用户可以执行cd命令，将act的目录作为当前的工作目录了。</p>
<p>现在删除一下这个server.properties试试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mars@ubuntu:/tmp/act$ rm server.properties </div><div class="line">rm: remove write-protected regular empty file &apos;server.properties&apos;? y</div><div class="line">rm: cannot remove &apos;server.properties&apos;: Permission denied</div></pre></td></tr></table></figure>
<p>我们能够读取act目录中内容，能够进入act目录作为当前的工作目录，但是我们无法删除该目录下的文件是因为我们对于这个目录没有w权限<br>w权限主要是修改这个目录结构的权限</p>
<ul>
<li>在目录下新建文件或者目录</li>
<li>删除目录下的文件</li>
<li>对目录下的文件重命名</li>
<li>移动目录下的文件</li>
</ul>
<p>所以这个权限对于目录来说最重要，默认的目录建立的时候是755，也就是说others用户可以访问和读取文件夹的信息，但是不能修改文件夹的结构。对于一些重要的目录这些权限保证了和这个目录的安全，是非常实用的配置。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>linux中对于文件和目录的权限是有区别的<br>rwx对于文件代表着可读，可写和可执行，但是对于目录而言则分别表示可以读取目录的结构信息，可能更改目录的结构和能将这个目录作为当前工作目录。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://dongming.github.io/2017/02/12/Java中的日志一：log4j的使用/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="MING">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="MING'S BLOG">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="MING'S BLOG" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/12/Java中的日志一：log4j的使用/" itemprop="url">
                  Java中的日志(一)：log4j
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-12T16:47:34+08:00">
                2017-02-12
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/02/12/Java中的日志一：log4j的使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/12/Java中的日志一：log4j的使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>log4j是一个基于java的日志工具。它由牛人Ceki Gülcü在2001年发布，至今已经有了16年的历史，现在是Apache基金会的一个项目。经过这么多年的发展，在java生态圈中已经成了日志事实上的标准，很多早期的著名的应用都是依赖log4j来完成其日志记录的。查了一些资料，log4j始于1996年初的E.U. SEMPER （安全电子市场为欧洲）跟踪API的项目，经过了无数的改进最终发布成了现在的log4j。然而，任何事物都有英雄迟暮，美人白头的那一天，虽然第一代log4j现在可能已经不是记录日志的首选工具，但是看看后来的log4c,log4cpp,log4net等日志工具的命名，就应该能够感受到log4j如日中天时在业界的江湖地位。</p>
<h3 id="log4j配置的3个重要组件-以properties为例"><a href="#log4j配置的3个重要组件-以properties为例" class="headerlink" title="log4j配置的3个重要组件(以properties为例)"></a>log4j配置的3个重要组件(以properties为例)</h3><h4 id="日志信息的优先级"><a href="#日志信息的优先级" class="headerlink" title="日志信息的优先级"></a>日志信息的优先级</h4><p>在log4j中日志的级别分为OFF、FATAL、ERROR、WARN、INFO、DEBUG、ALL，我们常用的主要是ERROR、WARN、INFO、DEBUG这四个级别。优先级从高到底以此为ERROR&gt;WARN&gt;INFO&gt;DEBUG,在将日志级别配置为DEBUG时，ERROR,WARN,INFO日志也都打印；当把日志级别配置为INFO时，ERROR,WARN级别也都被打印，依次类推。每个级别的简要说明</p>
<ul>
<li>ERROR:程序内部发生的错误，打印在日志中，应用能够继续运行</li>
<li>WARN:应用内部的告警，可能会引起应用工作不正常</li>
<li>INFO:能够在粗粒度上打印应用程序正在运行的情况，尽量保持在最低限度，INFO日志打印过多会影响应用的性能</li>
<li>DEBUG:详细的程序运行流程信息，将这些信息记录到文件中，能够通过DEBUG日志定位问题</li>
</ul>
<p>这样简单明了的打印应用的日志无论对日常运维和问题的定位都是非常有帮助的。日志过少可能信息量不够，无法判断出问题的所在；日志过多也会有同样的问题。曾经优化过一个系统性能，发现里面日志打印量巨大，把这些日志去掉后性能提升了25%左右。询问当时的开发人员为什么打印这多日志，他说日志全部打印出来分析问题比较容易。但是在一些性能测试中，模拟几万个节点的并发调用，在这种情况下日志本身就能压垮你的系统，更不要提业务了。</p>
<h4 id="日志文件的输出目的地"><a href="#日志文件的输出目的地" class="headerlink" title="日志文件的输出目的地"></a>日志文件的输出目的地</h4><p>在log4j的配置文件中，描述输出目的地信息的配置叫做Appender。在log4j中有很多种的Appender:</p>
<ul>
<li>org.apache.log4j.ConsoleAppender   将日志输出到控制台</li>
<li>org.apache.log4j.FileAppender      将日志输出到文件</li>
<li>org.apache.log4j.DailyRollingFileAppender 将每天的日志输出到一个文件</li>
<li>org.apache.log4j.RollingFileAppender      当一个日志文件到达一定大小时，重新创建一个新的日志文件</li>
<li>org.apache.log4j.WriterAppender           将日志以流的方式发送到其他地方</li>
</ul>
<p>当然你也可以定义自己的Appender，在上面这些Appender中在实际的工程中运用的最多的我觉得是ConsoleAppender和RollingFileAppender。console在调试运行或者一些小程序的时候是比较方便的，而RollingFileAppender由于其大小可控制，绕接的日志文件个数也是可控制的，等于有了一个自己清理老化数据的能力，所以在实际的工程运用中还是比较多的。唯一的缺点在于定位问题时，时间过长的日志数据会被绕接掉，现在云化的开发环境中，一般应用都会有日志收集器，日志都会及时的存储到日志中心所以这个问题也就不存在了。</p>
<h4 id="日志信息的格式"><a href="#日志信息的格式" class="headerlink" title="日志信息的格式"></a>日志信息的格式</h4><p>日志信息的格式，用log4j专用的属于叫做layout，也就是布局。log4j主要提供了如下几种布局</p>
<ul>
<li>org.apache.log4j.HTMLLayout </li>
<li>org.apache.log4j.PatternLayout</li>
<li>org.apache.log4j.SimpleLayout </li>
<li>org.apache.log4j.TTCCLayout</li>
</ul>
<p>在实际的工程应用中，使用的最多的应该是PatternLayout，它能够灵活的配置日志的格式。往往一个大的应用的日志格式都是一致的，这样便于后期对日志进行分析。</p>
<p>了解了log4j这几个重要的概念就可以在实际的项目中使用了。</p>
<h3 id="在代码中使用log4j"><a href="#在代码中使用log4j" class="headerlink" title="在代码中使用log4j"></a>在代码中使用log4j</h3><h4 id="添加log4j的依赖"><a href="#添加log4j的依赖" class="headerlink" title="添加log4j的依赖"></a>添加log4j的依赖</h4><p>maven仍然是java应用最主流的项目工程构建和管理工具。我们使用log4j最后的发布版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;log4j&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;log4j&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;1.2.17&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure>
<p>添加完依赖后写一个简单的日志的测试类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">package com.berrybay.log;</div><div class="line"></div><div class="line">import org.apache.log4j.Logger;</div><div class="line"></div><div class="line">public class SimpleLog &#123;</div><div class="line">    public static final Logger logger = Logger.getLogger(SimpleLog.class);</div><div class="line">    public static void main(String[] args)</div><div class="line">    &#123;</div><div class="line">        logger.error(&quot;this is error log&quot;);</div><div class="line">        logger.warn(&quot;this is warn log&quot;);</div><div class="line">        logger.info(&quot;this is info log&quot;);</div><div class="line">        logger.debug(&quot;this is debug log&quot;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们在一个main函数中依次输出error，warn，info，debug四种日志。前面说过了要同时输出这四种日志对日志的级别是有要求的，如果我们选择日志级别为ERROR时，只会输出ERROR日志，因为它的级别在这四种日志中最高。所以我们选择debug级别。下面是log4j.properties配置文件的内容，我们把日志输出到console和file两个地方</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">log4j.rootLogger = debug,stdout,rollingfile</div><div class="line"></div><div class="line">#输出信息到控制台</div><div class="line">log4j.appender.stdout = org.apache.log4j.ConsoleAppender</div><div class="line">log4j.appender.stdout.Target = System.out</div><div class="line">log4j.appender.stdout.layout = org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.stdout.layout.ConversionPattern = [%-5p] %d&#123;yyyy-MM-dd HH:mm:ss,SSS&#125; method:%l%n%m%n</div><div class="line"></div><div class="line">#輸出信息到rolling file</div><div class="line">##定义日志输出到哪里</div><div class="line">log4j.appender.rollingfile = org.apache.log4j.RollingFileAppender</div><div class="line">log4j.appender.rollingfile.File = D:\\dm_code\\logFile\\simplelog.log</div><div class="line">log4j.appender.rollingfile.Threshold = DEBUG</div><div class="line">##定义日志的格式</div><div class="line">log4j.appender.rollingfile.layout = org.apache.log4j.PatternLayout</div><div class="line">log4j.appender.rollingfile.layout.ConversionPattern = %-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</div></pre></td></tr></table></figure>
<p>在上面的配置文件中，我们定义了两个appender:ConsoleAppender,RollingFileAppender我们将打印的日志同时输出到控制台和simplelog.log文件中，可以看一下执行结果</p>
<p>这是IDEA控制台的输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&quot;C:\Program Files\Java\jdk1.8.0_111\bin\java&quot; -Didea.launcher.port=7533 &quot;-Didea.launcher.bin.path=C:\Program Files (x86)\JetBrains\IntelliJ IDEA 2016.2.5\bin&quot; -Dfile.encoding=UTF-8 -classpath &quot;C:\Program Files\Java\jdk1.8.0_111\jre\lib\charsets.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\deploy.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\access-bridge-64.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\cldrdata.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\dnsns.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\jaccess.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\jfxrt.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\localedata.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\nashorn.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\sunec.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\sunjce_provider.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\sunmscapi.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\sunpkcs11.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\ext\zipfs.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\javaws.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\jce.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\jfr.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\jfxswt.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\jsse.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\management-agent.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\plugin.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\resources.jar;C:\Program Files\Java\jdk1.8.0_111\jre\lib\rt.jar;D:\dm_code\learn-test\target\classes;D:\dev-tool\maven_localRepository\log4j\log4j\1.2.17\log4j-1.2.17.jar;C:\Program Files (x86)\JetBrains\IntelliJ IDEA 2016.2.5\lib\idea_rt.jar&quot; com.intellij.rt.execution.application.AppMain com.berrybay.log2.SimpleLog2</div><div class="line">2017-02-14 22:51:36  [ main:0 ] - [ ERROR ]  this is error log</div><div class="line">2017-02-14 22:51:36  [ main:1 ] - [ WARN ]  this is warn log</div><div class="line">2017-02-14 22:51:36  [ main:2 ] - [ INFO ]  this is info log</div><div class="line">2017-02-14 22:51:36  [ main:2 ] - [ DEBUG ]  this is debug log</div><div class="line"></div><div class="line">Process finished with exit code 0</div></pre></td></tr></table></figure>
<p>下面是simplelog.log文件中的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">2017-02-14 22:32:34  [ main:0 ] - [ ERROR ]  this is error log</div><div class="line">2017-02-14 22:32:34  [ main:2 ] - [ WARN ]  this is warn log</div><div class="line">2017-02-14 22:32:34  [ main:3 ] - [ INFO ]  this is info log</div><div class="line">2017-02-14 22:32:34  [ main:5 ] - [ DEBUG ]  this is debug log</div></pre></td></tr></table></figure>
<p>我们发现两个地方输出的日志是一样，这是因为这两个appender使用了相同的日志级别和相同的日志格式。我们也可以将文件的日志级别设置成其他级别，只需要修改log4j.appender.rollingfile.Threshold这个配置项就可以了。</p>
<p>在实际的日常使用中整个应用不仅仅包含我们自己的代码，还包括很多第三方jar包，比如mybatis，netty和其他apache的包。我们不想打印所有的日志，比如对于那些中间件我们只需要开ERROR日志，我们的应用开INFO日志，这样才能在掌握自己应用运行的情况下更好的提高整体的性能。</p>
<p>清空日志，创建一个新的包log2,我们让log的日志输出级别为WARN，让log2的日志输出级别为ERROR。下面是配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">log4j.logger.com.berrybay.log=WARN</div><div class="line">log4j.logger.com.berrybay.log2=ERROR</div></pre></td></tr></table></figure>
<p>只要增加如上的配置就能控制一些特定的类的日志输出级别，也就是可以控制某个模块的日志输出级别，这个是非常实用的一个地方。<br>关于log4j还有一个没有总结，就是日志的格式如何配置，这样总结的文章有很多，摘录如下：</p>
<ul>
<li>%p 输出优先级，即DEBUG，INFO，WARN，ERROR，FATAL  </li>
<li>%r 输出自应用启动到输出该log信息耗费的毫秒数  </li>
<li>%c 输出所属的类目，通常就是所在类的全名  </li>
<li>%t 输出产生该日志事件的线程名  </li>
<li>%n 输出一个回车换行符，Windows平台为“rn”，Unix平台为“n”  </li>
<li>%d 输出日志时间点的日期或时间，默认格式为ISO8601，也可以在其后指定格式，比如：%d{yyy MMM dd HH:mm:ss,SSS}，输出类似：2002年10月18日 22：10：28，921  </li>
<li>%l 输出日志事件的发生位置，包括类目名、发生的线程，以及在代码中的行数。举例：Testlog4.main(TestLog4.java:10)</li>
<li>%m 输出与日志记录事件相关联的应用程序提供的消息</li>
</ul>
<p>在看一下我们上面在log4j中配置的内容:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n</div></pre></td></tr></table></figure>
<p>从我们上面的内容中我们得出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">2017-02-14 22:32:34  [ main:0 ] - [ ERROR ]  this is error log</div><div class="line">2017-02-14 22:32:34  [ main:2 ] - [ WARN ]  this is warn log</div></pre></td></tr></table></figure>
<p>我们的日志中记录了:日志时间，日志线程名称，日志输出到应用启动的时间，日志的级别，日志的内容和回车符</p>
<p>小伙伴们根据上面的信息就可以随意配置出自己想要打印的日志格式了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  

          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="MING" />
          <p class="site-author-name" itemprop="name">MING</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">MING</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"guavago"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  












  
  

  

  

  

  


</body>
</html>
